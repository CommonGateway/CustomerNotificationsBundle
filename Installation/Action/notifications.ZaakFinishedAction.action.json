{
    "title": "ZaakFinishedAction",
    "$id": "https://commongateway.nl/action/notifications.ZaakFinishedAction.action.json",
    "$schema": "https://docs.commongateway.nl/schemas/Action.schema.json",
    "version": "0.0.1",
    "listens": ["notifications.notification.created"],
    "conditions":
    {
        "and": [
            {
                "==": [
                    {
                        "var": "method"
                    },
                    "POST"
                ]
            },
            {
                "==": [
                    {
                        "var": "body.kanaal"
                    },
                    "zaken"
                ]
            },
            {
                "==": [
                    {
                        "var": "body.resource"
                    },
                    "status"
                ]
            },
            {
                "==": [
                    {
                        "var": "body.actie"
                    },
                    "update"
                ]
            }
        ]
    },
    "class": "CommonGateway\\CustomerNotificationsBundle\\ActionHandler\\NotificationsHandler",
    "configuration": {
        "extraConditions": {
            "body.resourceUrl": {
                "commongatewaySourceRef": "https://buren.nl/source/buren.zrc.source.json",
                "statustype": "https://afgerondStatusTypeUrl"
            }
        },
        "emailConfig": {
            "getObjectDataConfig": {
                "notificationProperty": "body.hoofdObject",
                "source": "https://buren.nl/source/buren.zrc.source.json",
                "sourceProperties": ["rollen"],
                "getObjectDataConfig": {
                    "source": "https://buren.nl/source/buren.zrc.source.json",
                    "sourceProperties": ["bsn"],
                    "forParentProperties": ["rollen"]
                },
                "searchSchemas": ["https://commongateway.nl/klant.partij.schema.json"],
                "searchQuery": {
                    "externeIdentificaties.partijIdentificator.objectId": "{{bsn}}",
                    "externeIdentificaties.partijIdentificator.objecttype": "ingeschrevenpersoon"
                }
            },
            "throw": "throwForEmailAction"
        },
        "smsConfig": {
            "getObjectDataConfig": "sameAsEmail",
            "throw": "throwForSMSAction"
        },
        "createObjectConfig": {
            "schema": "Entity ref or uuid",
            "mapping": "Mapping ref or uuid"
        }
    }
}